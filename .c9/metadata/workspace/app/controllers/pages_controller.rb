{"changed":false,"filter":false,"title":"pages_controller.rb","tooltip":"/app/controllers/pages_controller.rb","value":"class PagesController < ApplicationController\n  layout 'application_main', only: [:home]\n  def home\n    @vets = Vet.all\n    @vetsreviewtime = @vets.joins(:reviews).group(:id).order('reviews.created_at DESC').page(params[:page])\n    \n  end\n  \n  def search\n    @vets = Vet.ransack(vtitle_cont: params[:q]).result(distinct: true)\n    @vets = @vets.order(:vtitle).reverse_order.page(params[:page])\n    @searchresult = params[:q]    \n    respond_to do |format|\n      format.html {}\n      format.json {\n        @vets = @vets.limit(5)\n      }\n    end\n    \n  end\n  \n  def searchreview\n    @vets = Vet.ransack(vtitle_cont: params[:q]).result(distinct: true)\n    @vetsreview = @vets.joins(:reviews).group(:id).order('count(reviews.id) DESC').page(params[:page])\n    @searchresult = params[:q]    \n    respond_to do |format|\n      format.html {}\n      format.json {\n        @vetsreview = @vetsreview.limit(5)\n      }\n    end\n    \n  end\n  \n  def searchstar\n    @vets = Vet.ransack(vtitle_cont: params[:q]).result(distinct: true)\n    @vetsstar = @vets.joins(:reviews).group(:id).order(' DESC').page(params[:page])\n    @searchresult = params[:q]    \n    respond_to do |format|\n      format.html {}\n      format.json {\n        @vetsstar = @vetsstar.limit(5)\n      }\n    end\n    \n  end\n  \n  # def averagerating(@vets)\n  #   i=0\n\n  #   while i == @vets.reviews.count\n  #     @sum += @vets.reviews[i]\n  #     i++\n  #   end\n  #   @sum = @sum/(@vets.reviews.count)\n  # end\n  \n  # def introduction\n  # end\n  \n  \n  # private\n  \n  # def sum\n  #   @sum =0\n  # end\n\nend\n\n\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":296.5,"scrollleft":0,"selection":{"start":{"row":10,"column":1},"end":{"row":10,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":20,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1501979727357}